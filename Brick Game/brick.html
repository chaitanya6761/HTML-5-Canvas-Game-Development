<html>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
var canvas;
var canvasContext;
var mouseX;
var mouseY;

var ballX = 50;
var ballY = 50;
var ballSpeedX = 10;
var ballSpeedY = 4;

var paddleX = 350;

const PADDLE_WIDTH = 100;
const PADDlE_THICKNESS = 10;
const PADDLE_FRM_EDGE = 30;

const BRICK_WIDTH = 80;
const BRICK_HEIGHT = 20;
const BRICK_GAP = 2;
const BRICK_COLS = 18;
const BRICK_ROWS = 14;


var bricks = new Array(BRICK_COLS * BRICK_ROWS);

function updateMousePos(evt)
{
	var rect = canvas.getBoundingClientRect();
	var root = document.documentElement;
	mouseX = evt.clientX - rect.left - root.scrollLeft;
	mouseY = evt.clientY - rect.top - root.scrollTop;
	
	paddleX = mouseX - PADDLE_WIDTH/2;
}

function brickReset()
{
	for(var i = 0;i<BRICK_COLS * BRICK_ROWS;i++)
	{
		bricks[i] = true;
	}
}

window.onload = function(){

	canvas = document.getElementById('gameCanvas');
	canvasContext = canvas.getContext('2d');
	
	var framesPerSecond = 30;
	setInterval(function(){
	moveEveryThing();
	drawEveryThing();
	}, 1000/framesPerSecond );
	
	canvas.addEventListener('mousemove',updateMousePos);
	brickReset();
	
}

function ballReset()
{
	ballX = canvas.width/2;
	ballY = canvas.height/2;
}

function moveEveryThing()
{
	ballX = ballX + ballSpeedX;
	ballY = ballY + ballSpeedY;
	
	if(ballX > canvas.width || ballX < 0)
	{
		ballSpeedX = - ballSpeedX;
	}
	
	if(ballY < 0)
	{
		ballSpeedY *= -1;
	}
	
	if(ballY > canvas.height)
	{
		//ballSpeedY = - ballSpeedY;
		ballReset();
	}
	
	var paddleTopEdgeY = canvas.height - PADDLE_FRM_EDGE;
	var paddleBottomEdgeY = paddleTopEdgeY + PADDlE_THICKNESS;
	var paddleLeftX = paddleX;
	var paddleRightX = paddleX + PADDLE_WIDTH;
	
	if(ballY > paddleTopEdgeY && ballY < paddleBottomEdgeY && ballX > paddleLeftX && ballX < paddleRightX )
	{
		ballSpeedY = - ballSpeedY;
		
		var centerOfPaddle = paddleX + PADDLE_WIDTH/2;
		var ballDistFrmCenter = ballX - centerOfPaddle;
		
		ballSpeedX = ballDistFrmCenter*0.35;
	}
	
}

function drawBricks()
{
	for(var eachRow=0;eachRow < BRICK_ROWS; eachRow++)	
	{
		for(var eachCol=0;eachCol<BRICK_COLS;eachCol++)
		{
			var index = BRICK_COLS * eachRow + eachCol;
		
			if(bricks[index])
			{
				colorRect(BRICK_WIDTH*eachCol,BRICK_HEIGHT*eachRow,BRICK_WIDTH-BRICK_GAP,BRICK_HEIGHT-BRICK_GAP,'blue');
			}
		}
	}
}


function drawEveryThing()
{ 
	//draw the canvas
	colorRect(0,0,canvas.width,canvas.height,'black');
	
	//draw the paddle
	colorRect(paddleX,canvas.height - PADDLE_FRM_EDGE,PADDLE_WIDTH,PADDlE_THICKNESS,'yellow');
	
	//draws the ball 
	colorCircle(ballX,ballY,10,'white');
	
	drawBricks();
	
	colorText(mouseX+","+mouseY,mouseX,mouseY,'white');
		
}

function colorRect(leftX,topY,width,height,drawColor)
{
	canvasContext.fillStyle = drawColor;
	canvasContext.fillRect(leftX,topY,width,height);
}

function colorCircle(centerX,centerY,radius,drawColor)
{
	canvasContext.fillStyle = drawColor;
	canvasContext.beginPath();
	canvasContext.arc(centerX,centerY,radius,0,Math.PI*2,true);
	canvasContext.fill();
}

function colorText(msg,x,y,color)
{
	canvasContext.fillStyle = color;
	canvasContext.fillText(msg,x,y);
}

</script>

</html>
